<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE nta PUBLIC '-//Uppaal Team//DTD Flat System 1.1//EN' 'http://www.it.uu.se/research/group/darts/uppaal/flat-1_2.dtd'>
<nta>
	<declaration>// Place global declarations here.

bool mission_complete = false;
bool mission_failed = false;

broadcast chan start_object_get_0;
broadcast chan finish_object_get_0;
bool object_get_0_failed = false;

broadcast chan start_battery_recharge_0;
broadcast chan finish_battery_recharge_0;
bool battery_recharge_0_failed = false;

broadcast chan start_objects_delivery_0;
broadcast chan finish_objects_delivery_0;
bool objects_delivery_0_failed = false;

broadcast chan start_object_returning_0;
broadcast chan finish_object_returning_0;
bool object_returning_0_failed = false;

broadcast chan start_alert_trigger_0;
broadcast chan finish_alert_trigger_0;
bool alert_trigger_0_failed = false;


void startMission() {
// starts mission with following values, you may change the values to your liking
	mission_complete = false;
	mission_failed = false;

}


</declaration>
	<template>
		<name x="0" y="0">goal_model_template</name>
		<location id="id0" x="417" y="502">
			<name x="417" y="468">beginMissionNode</name>
		</location>
		<location id="id1" x="417" y="204">
			<name x="434" y="170">missionFailed</name>
		</location>
		<location id="id2" x="1496" y="561">
			<name x="1368" y="535">missionComplete</name>
		</location>
		<location id="id3" x="604" y="502">
			<name x="604" y="468">goal_G3</name>
		</location>
		<location id="id4" x="723" y="502">
			<name x="723" y="468">goal_G6</name>
		</location>
		<location id="id5" x="816" y="502">
			<name x="816" y="468">goal_G7</name>
		</location>
		<location id="id6" x="918" y="502">
			<name x="918" y="468">goal_G9</name>
		</location>
		<location id="id7" x="918" y="400">
			<name x="918" y="374">exec_AT1</name>
		</location>
		<location id="id8" x="918" y="298">
			<name x="918" y="272">finish_AT1</name>
		</location>
		<location id="id9" x="1164" y="510">
			<name x="1164" y="476">goal_G10</name>
		</location>
		<location id="id10" x="1164" y="391">
			<name x="1164" y="365">exec_AT2</name>
		</location>
		<location id="id11" x="1164" y="289">
			<name x="1164" y="263">finish_AT2</name>
		</location>
		<location id="id12" x="977" y="161">
			<name x="977" y="127">goal_G11</name>
		</location>
		<location id="id13" x="791" y="102">
			<name x="791" y="68">goal_G12</name>
		</location>
		<location id="id14" x="791" y="0">
			<name x="791" y="-34">exec_AT3</name>
		</location>
		<location id="id15" x="791" y="-102">
			<name x="808" y="-119">finish_AT3</name>
		</location>
		<location id="id16" x="1114" y="102">
			<name x="1105" y="68">goal_G13</name>
		</location>
		<location id="id17" x="1284" y="102">
			<name x="1284" y="68">goal_G14</name>
		</location>
		<location id="id18" x="1284" y="0">
			<name x="1284" y="-34">exec_AT4</name>
		</location>
		<location id="id19" x="1284" y="-102">
			<name x="1292" y="-127">finish_AT4</name>
		</location>
		<location id="id20" x="1623" y="102">
			<name x="1623" y="68">goal_G15</name>
		</location>
		<location id="id21" x="1623" y="-17">
			<name x="1623" y="-51">exec_AT5</name>
		</location>
		<location id="id22" x="1623" y="-145">
			<name x="1640" y="-171">finish_AT5</name>
		</location>
		<init ref="id0"/>
		<transition>
			<source ref="id1"/>
			<target ref="id0"/>
			<label kind="assignment" x="425" y="331">mission_failed = true</label>
		</transition>
		<transition>
			<source ref="id2"/>
			<target ref="id0"/>
			<label kind="assignment" x="484" y="535">mission_complete = true</label>
			<nail x="417" y="553"/>
		</transition>
		<transition>
			<source ref="id0"/>
			<target ref="id3"/>
			<label kind="assignment" x="468" y="502">startMission()</label>
		</transition>
		<transition>
			<source ref="id3"/>
			<target ref="id4"/>
		</transition>
		<transition>
			<source ref="id4"/>
			<target ref="id5"/>
		</transition>
		<transition>
			<source ref="id5"/>
			<target ref="id6"/>
		</transition>
		<transition>
			<source ref="id6"/>
			<target ref="id7"/>
			<label kind="synchronisation" x="918" y="451">start_object_get_0!</label>
		</transition>
		<transition>
			<source ref="id7"/>
			<target ref="id8"/>
			<label kind="synchronisation" x="918" y="349">finish_object_get_0?</label>
		</transition>
		<transition>
			<source ref="id8"/>
			<target ref="id9"/>
			<label kind="guard" x="986" y="484">object_get_0_failed == true</label>
			<nail x="986" y="510"/>
		</transition>
		<transition>
			<source ref="id9"/>
			<target ref="id10"/>
			<label kind="synchronisation" x="1164" y="442">start_battery_recharge_0!</label>
		</transition>
		<transition>
			<source ref="id10"/>
			<target ref="id11"/>
			<label kind="synchronisation" x="1164" y="340">finish_battery_recharge_0?</label>
		</transition>
		<transition>
			<source ref="id11"/>
			<target ref="id12"/>
			<label kind="guard" x="986" y="161">battery_recharge_0_failed == false</label>
			<nail x="1207" y="161"/>
		</transition>
		<transition>
			<source ref="id12"/>
			<target ref="id13"/>
		</transition>
		<transition>
			<source ref="id13"/>
			<target ref="id14"/>
			<label kind="synchronisation" x="621" y="51">start_objects_delivery_0!</label>
		</transition>
		<transition>
			<source ref="id14"/>
			<target ref="id15"/>
			<label kind="synchronisation" x="612" y="-59">finish_objects_delivery_0?</label>
		</transition>
		<transition>
			<source ref="id15"/>
			<target ref="id16"/>
			<label kind="guard" x="893" y="77">objects_delivery_0_failed == true</label>
			<nail x="892" y="102"/>
		</transition>
		<transition>
			<source ref="id16"/>
			<target ref="id17"/>
		</transition>
		<transition>
			<source ref="id17"/>
			<target ref="id18"/>
			<label kind="synchronisation" x="1292" y="34">start_object_returning_0!</label>
		</transition>
		<transition>
			<source ref="id18"/>
			<target ref="id19"/>
			<label kind="synchronisation" x="1122" y="-68">finish_object_returning_0?</label>
		</transition>
		<transition>
			<source ref="id19"/>
			<target ref="id20"/>
			<label kind="guard" x="1385" y="76">object_returning_0_failed == true</label>
			<nail x="1377" y="102"/>
		</transition>
		<transition>
			<source ref="id20"/>
			<target ref="id21"/>
			<label kind="synchronisation" x="1623" y="8">start_alert_trigger_0!</label>
		</transition>
		<transition>
			<source ref="id21"/>
			<target ref="id22"/>
			<label kind="synchronisation" x="1623" y="-76">finish_alert_trigger_0?</label>
		</transition>
		<transition>
			<source ref="id8"/>
			<target ref="id12"/>
			<label kind="guard" x="731" y="272">object_get_0_failed == false</label>
			<nail x="714" y="297"/>
			<nail x="833" y="161"/>
		</transition>
		<transition>
			<source ref="id15"/>
			<target ref="id2"/>
			<label kind="guard" x="850" y="-102">objects_delivery_0_failed == false</label>
			<nail x="1079" y="-102"/>
		</transition>
		<transition>
			<source ref="id19"/>
			<target ref="id2"/>
			<label kind="guard" x="1351" y="-102">object_returning_0_failed == false</label>
			<nail x="1572" y="-102"/>
			<nail x="1606" y="187"/>
		</transition>
		<transition>
			<source ref="id11"/>
			<target ref="id1"/>
			<label kind="guard" x="569" y="178">battery_recharge_0_failed == true</label>
			<nail x="782" y="204"/>
		</transition>
		<transition>
			<source ref="id22"/>
			<target ref="id1"/>
			<label kind="guard" x="901" y="-170">alert_trigger_0_failed == true</label>
			<nail x="1224" y="-144"/>
			<nail x="417" y="-136"/>
		</transition>
		<transition>
			<source ref="id22"/>
			<target ref="id2"/>
			<label kind="guard" x="1649" y="-144">alert_trigger_0_failed == false</label>
			<nail x="1853" y="-144"/>
			<nail x="1521" y="561"/>
		</transition>
	</template>
	<template>
		<name x="5" y="5">temp_object_get_0</name>
		<location id="id23" x="-552" y="-93">
			<name x="-594" y="-127">init_node</name>
		</location>
		<location id="id24" x="-552" y="-220">
			<name x="-566" y="-251">get_object</name>
		</location>
		<location id="id25" x="-177" y="-220">
			<name x="-193" y="-251">end_method</name>
		</location>
		<location id="id26" x="-864" y="-220">
			<name x="-878" y="-251">default_failure_node</name>
		</location>
		<init ref="id23"/>
		<transition>
			<source ref="id25"/>
			<target ref="id23"/>
			<label kind="synchronisation" x="-427" y="-115">finish_object_get_0!</label>
			<nail x="-177" y="-93"/>
		</transition>
		<transition>
			<source ref="id24"/>
			<target ref="id26"/>
			<label kind="assignment" x="-799" y="-215">object_get_0_failed = true</label>
		</transition>
		<transition>
			<source ref="id26"/>
			<target ref="id25"/>
			<nail x="-864" y="68"/>
			<nail x="100" y="76"/>
		</transition>
		<transition>
			<source ref="id23"/>
			<target ref="id24"/>
			<label kind="synchronisation" x="-705" y="-144">start_object_get_0?</label>
		</transition>
		<transition>
			<source ref="id24"/>
			<target ref="id25"/>
		</transition>
	</template>
	<template>
		<name x="5" y="5">temp_battery_recharge_0</name>
		<location id="id27" x="-552" y="-93">
			<name x="-594" y="-127">init_node</name>
		</location>
		<location id="id28" x="-552" y="-220">
			<name x="-566" y="-251">recharge_battery</name>
		</location>
		<location id="id29" x="-177" y="-220">
			<name x="-193" y="-251">end_method</name>
		</location>
		<location id="id30" x="-864" y="-220">
			<name x="-878" y="-251">default_failure_node</name>
		</location>
		<init ref="id27"/>
		<transition>
			<source ref="id29"/>
			<target ref="id27"/>
			<label kind="synchronisation" x="-427" y="-115">finish_battery_recharge_0!</label>
			<nail x="-177" y="-93"/>
		</transition>
		<transition>
			<source ref="id28"/>
			<target ref="id30"/>
			<label kind="assignment" x="-799" y="-215">battery_recharge_0_failed = true</label>
		</transition>
		<transition>
			<source ref="id30"/>
			<target ref="id29"/>
			<nail x="-864" y="68"/>
			<nail x="100" y="76"/>
		</transition>
		<transition>
			<source ref="id27"/>
			<target ref="id28"/>
			<label kind="synchronisation" x="-705" y="-144">start_battery_recharge_0?</label>
		</transition>
		<transition>
			<source ref="id28"/>
			<target ref="id29"/>
		</transition>
	</template>
	<template>
		<name x="5" y="5">temp_objects_delivery_0</name>
		<location id="id31" x="-552" y="-93">
			<name x="-594" y="-127">init_node</name>
		</location>
		<location id="id32" x="-552" y="-220">
			<name x="-566" y="-251">deliver_objects</name>
		</location>
		<location id="id33" x="-177" y="-220">
			<name x="-193" y="-251">end_method</name>
		</location>
		<location id="id34" x="-864" y="-220">
			<name x="-878" y="-251">default_failure_node</name>
		</location>
		<init ref="id31"/>
		<transition>
			<source ref="id33"/>
			<target ref="id31"/>
			<label kind="synchronisation" x="-427" y="-115">finish_objects_delivery_0!</label>
			<nail x="-177" y="-93"/>
		</transition>
		<transition>
			<source ref="id32"/>
			<target ref="id34"/>
			<label kind="assignment" x="-799" y="-215">objects_delivery_0_failed = true</label>
		</transition>
		<transition>
			<source ref="id34"/>
			<target ref="id33"/>
			<nail x="-864" y="68"/>
			<nail x="100" y="76"/>
		</transition>
		<transition>
			<source ref="id31"/>
			<target ref="id32"/>
			<label kind="synchronisation" x="-705" y="-144">start_objects_delivery_0?</label>
		</transition>
		<transition>
			<source ref="id32"/>
			<target ref="id33"/>
		</transition>
	</template>
	<template>
		<name x="5" y="5">temp_object_returning_0</name>
		<location id="id35" x="-552" y="-93">
			<name x="-594" y="-127">init_node</name>
		</location>
		<location id="id36" x="-552" y="-220">
			<name x="-566" y="-251">return_objects</name>
		</location>
		<location id="id37" x="-177" y="-220">
			<name x="-193" y="-251">end_method</name>
		</location>
		<location id="id38" x="-864" y="-220">
			<name x="-878" y="-251">default_failure_node</name>
		</location>
		<init ref="id35"/>
		<transition>
			<source ref="id37"/>
			<target ref="id35"/>
			<label kind="synchronisation" x="-427" y="-115">finish_object_returning_0!</label>
			<nail x="-177" y="-93"/>
		</transition>
		<transition>
			<source ref="id36"/>
			<target ref="id38"/>
			<label kind="assignment" x="-799" y="-215">object_returning_0_failed = true</label>
		</transition>
		<transition>
			<source ref="id38"/>
			<target ref="id37"/>
			<nail x="-864" y="68"/>
			<nail x="100" y="76"/>
		</transition>
		<transition>
			<source ref="id35"/>
			<target ref="id36"/>
			<label kind="synchronisation" x="-705" y="-144">start_object_returning_0?</label>
		</transition>
		<transition>
			<source ref="id36"/>
			<target ref="id37"/>
		</transition>
	</template>
	<template>
		<name x="5" y="5">temp_alert_trigger_0</name>
		<location id="id39" x="-552" y="-93">
			<name x="-594" y="-127">init_node</name>
		</location>
		<location id="id40" x="-552" y="-220">
			<name x="-566" y="-251">trigger_alert</name>
		</location>
		<location id="id41" x="-177" y="-220">
			<name x="-193" y="-251">end_method</name>
		</location>
		<location id="id42" x="-864" y="-220">
			<name x="-878" y="-251">default_failure_node</name>
		</location>
		<init ref="id39"/>
		<transition>
			<source ref="id41"/>
			<target ref="id39"/>
			<label kind="synchronisation" x="-427" y="-115">finish_alert_trigger_0!</label>
			<nail x="-177" y="-93"/>
		</transition>
		<transition>
			<source ref="id40"/>
			<target ref="id42"/>
			<label kind="assignment" x="-799" y="-215">alert_trigger_0_failed = true</label>
		</transition>
		<transition>
			<source ref="id42"/>
			<target ref="id41"/>
			<nail x="-864" y="68"/>
			<nail x="100" y="76"/>
		</transition>
		<transition>
			<source ref="id39"/>
			<target ref="id40"/>
			<label kind="synchronisation" x="-705" y="-144">start_alert_trigger_0?</label>
		</transition>
		<transition>
			<source ref="id40"/>
			<target ref="id41"/>
		</transition>
	</template>
	<system>var_temp_object_get_0 = temp_object_get_0();
var_temp_battery_recharge_0 = temp_battery_recharge_0();
var_temp_objects_delivery_0 = temp_objects_delivery_0();
var_temp_object_returning_0 = temp_object_returning_0();
var_temp_alert_trigger_0 = temp_alert_trigger_0();
var_goal_model_template = goal_model_template();
system var_goal_model_template,var_temp_object_get_0,var_temp_battery_recharge_0,var_temp_objects_delivery_0,var_temp_object_returning_0,var_temp_alert_trigger_0;</system>
	<queries>
		<query>
			<formula></formula>
			<comment></comment>
		</query>
		<query>
			<formula>A[] not deadlock</formula>
			<comment>Basic formula query to verify absence of deadlocks</comment>
		</query>
		<query>
			<formula>A[] var_goal_model_template.goal_G11 imply not object_get_0_failed </formula>
			<comment>Meant to fail, this one shows that G11 is executed if AT1 or AT2 (if AT1 fails) successfully execute, not just AT1, once again showing that the fallback structure is sound</comment>
		</query>
		<query>
			<formula>A[] var_goal_model_template.goal_G11 imply not object_get_0_failed or object_get_0_failed and not battery_recharge_0_failed</formula>
			<comment>For all paths: Goal G11 is reached if AT1 or AT2 (in case AT1 fails)are successfully completed, it also means that G9 is completed</comment>
		</query>
		<query>
			<formula>A[] mission_complete imply 
(not object_get_0_failed) or (object_get_0_failed and not battery_recharge_0_failed) and 
(not objects_delivery_0_failed) or (objects_delivery_0_failed and not object_returning_0_failed) or (object_returning_0_failed and not alert_trigger_0_failed)</formula>
			<comment>Mission complete is achieved by adopting one of the execution paths available in Equation \ref{}</comment>
		</query>
		<query>
			<formula>E&lt;&gt; mission_complete</formula>
			<comment></comment>
		</query>
		<query>
			<formula>E&lt;&gt; mission_failed</formula>
			<comment></comment>
		</query>
	</queries>
</nta>
